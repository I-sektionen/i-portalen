{% extends "master.html" %}
{% block hero %}{% endblock %}
{% block title %}Gör en bokning{% endblock %}
{% block content %}
    {% comment %}
        jQuery script   - Fetches todays date
                        - Fetches this week, and next.
                        - Fetches slots
                        - Renders html elements.
                        - UI to select start and end.
                        - Connect to form for start and end.

                        - Next step: max slots, validation and so on.

        Django views:   - Todays date
                        - Days in week, given date.
                        - Slots, given bookable. Availability and so on.


    {% endcomment %}
    <div class="booking">
    {% comment %}
        This is where the booking form is rendered by the script booking.js
    {% endcomment %}
    </div>
    {% if week == 1 %}
    <a href="{% url "make_booking" bookable_id year   %}"><button type="button">Bakåt</button></a>

    {% endif %}
    <a href=""><button type="button">Framåt</button></a>
    <form method="post" action="{% url "make_booking" bookable_id %}">
    {% csrf_token %}
    {{ form }}

    <div class="calendar">
        {% for day in booking_status %}
            <div class="cal-day" id="{{day.swe_date}}">
                <div class="cal-day-header">
                    <h4>{{ day.date }}</h4>
                </div>
                {% for slot in day.slots %}
                    <div class="slot">
                        <p>Start: {{ slot.0.start_time }}</p>
                        <p>End: {{ slot.0.end_time }}</p>
                        <p>Free: {{ slot.1 }}</p>
                    </div>
                {% endfor %}
            </div>
        {% endfor %}
    <!-- End of calendar -->
    </div>
    <button type="submit">Boka</button>
    </form>
    <ul>
    {% for slot in booked_slots %}
        <li> {{ slot.slot }} | {{ slot.date}} </li>
    {% endfor %}
    </ul>

{% endblock %}

{% block after_scripts %}
 <script>
  /*
     $(function() {
    $( ".datepicker" ).datepicker({
      changeMonth: true,
      changeYear: true
    });
  });
  */
  jQuery(document).ready(function(){
                generate_booking_form({{ bookable_id }})
        });
  </script>

{% endblock %}